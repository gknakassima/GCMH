function Toro
  
    First    = [-9.1 -9.1 -2.1];
    Last     = [9.1 9.1 2.1];
    Division = [50 50 12]; 
  
    %MarchingSimplex(3, 1, First, Last, Division, @toro8_p, 'toro8_2_MS.pol');
    %MarchingHyperCube(3, First, Last, Division, @toro8_p, 'toro8_MHC.pol');
    GeneralizedMarchingHyperCube(3, 1, First, Last, Division, 'toro8_50.txt', @toro8_p); 
    
    return 

    function [f] = toro8(x) 
      t(1) = sqrt((x(1)-6.0)*(x(1)-6.0)+(x(2)-0.0)*(x(2)-0.0))-2.0;
      t(2) = sqrt((x(1)+6.0)*(x(1)+6.0)+(x(2)-0.0)*(x(2)-0.0))-2.0;
      t(3) = sqrt((x(1)-0.0)*(x(1)-0.0)+(x(2)-6.0)*(x(2)-6.0))-2.0;
      t(4) = sqrt((x(1)-0.0)*(x(1)-0.0)+(x(2)+6.0)*(x(2)+6.0))-2.0;
      t(5) = sqrt((x(1)-4.0)*(x(1)-4.0)+(x(2)-4.0)*(x(2)-4.0))-2.0;
      t(6) = sqrt((x(1)-4.0)*(x(1)-4.0)+(x(2)+4.0)*(x(2)+4.0))-2.0;
      t(7) = sqrt((x(1)+4.0)*(x(1)+4.0)+(x(2)-4.0)*(x(2)-4.0))-2.0;
      t(8) = sqrt((x(1)+4.0)*(x(1)+4.0)+(x(2)+4.0)*(x(2)+4.0))-2.0;
      for i = 1:8
          t(i) = t(i)*t(i)+x(3)*x(3)-1.0;
      end
      f(1) = t(1);
      for i = 2:8 
         if t(i) < f(1)
            f(1) = t(i);
         end
      end
      return
    end 

    function [f] = toro8_p(x) 
      p    = 2.0;
      t(1) = sqrt((x(1)-6.0)*(x(1)-6.0)+(x(2)-0.0)*(x(2)-0.0))-2.0;
      t(2) = sqrt((x(1)+6.0)*(x(1)+6.0)+(x(2)-0.0)*(x(2)-0.0))-2.0;
      t(3) = sqrt((x(1)-0.0)*(x(1)-0.0)+(x(2)-6.0)*(x(2)-6.0))-2.0;
      t(4) = sqrt((x(1)-0.0)*(x(1)-0.0)+(x(2)+6.0)*(x(2)+6.0))-2.0;
      t(5) = sqrt((x(1)-4.0)*(x(1)-4.0)+(x(2)-4.0)*(x(2)-4.0))-2.0;
      t(6) = sqrt((x(1)-4.0)*(x(1)-4.0)+(x(2)+4.0)*(x(2)+4.0))-2.0;
      t(7) = sqrt((x(1)+4.0)*(x(1)+4.0)+(x(2)-4.0)*(x(2)-4.0))-2.0;
      t(8) = sqrt((x(1)+4.0)*(x(1)+4.0)+(x(2)+4.0)*(x(2)+4.0))-2.0;
      f(1) = 0.0;
      for i = 1:8
          f(1) = f(1) + (t(i)*t(i)+x(3)*x(3))^(-p);
      end
      f(1) = f(1)^(-1.0/p) - 1.0;
      return
    end 

    
 end 